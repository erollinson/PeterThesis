---
title: "Untitled"
author: "EJR"
date: "2025-11-03"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(ggridges)
library(extrafont)
font_import()
data <- read.csv("focalgenera2.csv")


#presence absence
datasummary <- data %>%
  group_by(Genus, Time.Category, Present) %>%
  summarize(n = n()) %>%
  pivot_wider(names_from = Present, values_from = n, values_fill = 0) %>%
  mutate(prop_present = present/(present+absent))

text size is fixed for export at poster size
ggplot(datasummary) +
  theme_test() + 
  geom_col(aes(x = Time.Category, y = prop_present), fill = "#223204", alpha = 0.5, color = "black", width=0.5) +
  facet_wrap(~Genus, ncol = 2) +
  theme_test() + 
  theme(strip.text = element_text(face = "italic"), 
        axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)), 
        axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
        text = element_text(family = "Open Sans Semibold", size = 25)) +
  scale_x_discrete(labels = time_labs) + 
   scale_y_continuous(limits = c(0, 1), expand = c(0,0)) +
  xlab("Years Since Prescribed Burn") + 
  ylab("Proportion of Occurrence")


#density when present

presences <- data %>%
  filter(Present == "present")


ggplot(presences, aes(x = Time.Category, y = Daubenmeyer)) + 
  geom_jitter(size = 5, alpha = 0.1, width = 0.2, height = 0.01) + 
  facet_wrap(~Genus, ncol=2)

presences_summary <- presences %>%
  group_by(Genus, Time.Category) %>%
  summarize(median = median(Daubenmeyer))

time_labs <- c("<1", "1 - 5", "5 - 10", ">10", "No Burn")

#median and raw data option
ggplot() + 
  theme_test() +
  geom_col(data = presences_summary, aes(x = Time.Category, y = median), fill = "#7B1315", width=0.5, alpha = 0.5, color ="black") +
  geom_jitter(data = presences, aes(x = Time.Category, y = Daubenmeyer), width = 0.14, height = 0, size = 4, alpha = 0.5, pch = 21, fill = "#7B1315", color = "black") + 
  facet_wrap(~Genus, ncol = 2) +
  theme(strip.text = element_text(face = "italic"), 
        axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)), 
        axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1),
        text = element_text(family = "Open Sans Semibold", size = 25)) +
  scale_x_discrete(labels = time_labs) + 
  scale_y_continuous(limits = c(0, 5.2), expand = c(0,0)) +
  xlab("Years Since Prescribed Burn") + 
  ylab("Median Daubenmeyer Cover")

#dot color #223204, bar color tbd
#red is red: #7B1315


#dotplot option
ggplot() + 
  geom_col(data = presences_summary, aes(x = Time.Category, y = median), width=0.5, alpha = 0.5) + 
  geom_dotplot(data = presences, aes(x = Time.Category, y = Daubenmeyer), binaxis = "y", size = 4, alpha = 0.5, stackdir = "center") + 
  facet_wrap(~Genus, ncol = 2) + 
  theme_test() + 
  theme(strip.text = element_text(face = "italic"), 
        axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)), 
        axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
  scale_x_discrete(labels = time_labs) + 
  xlab("Time Since Prescribed Burn") + 
  ylab("Median Daubenmeyer Cover")


#ridgeline option
ggplot(presences, aes(y = Time.Category, x = Daubenmeyer)) + 
  geom_density_ridges(quantile_lines = TRUE, quantiles = 2, jittered_points = TRUE) + 
  facet_wrap(~Genus, ncol = 2) + 
  theme_test()


#binline option
ggplot(presences, aes(x = Daubenmeyer, y = Time.Category)) +
  geom_density_ridges(stat = "binline", bins = 5, scale = 2.2) +
  facet_wrap(~Genus, ncol = 2)

#fluctuation plot option
presence_tabs <- presences %>%
  group_by(Genus, Time.Category, Daubenmeyer) %>%
  summarize (N = n())

ggplot(presence_tabs, aes(x = Time.Category, y = Daubenmeyer)) + 
  geom_point(aes(size = N, alpha = N), stroke = NA)+
  scale_size_continuous(range = c(3, 15)) +
  facet_wrap(~Genus, ncol = 2) +
    theme_test() + 
  theme(strip.text = element_text(face = "italic"), 
        axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)), 
        axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
  scale_x_discrete(labels = time_labs) + 
  xlab("Time Since Prescribed Burn") + 
  ylab("Median Daubenmeyer Cover")
             

```


```{r}
#OLD
data <-read.csv("PostermasterdataSGLburns.csv")

cleandata <- data %>%
  filter(Genus %in% c("Gaylussacia", "Rubus", "Vaccinium", "Gaultheria"))

datasummary <- cleandata %>%
  group_by(Genus, Time.Category) %>%
  summarize (median = median(Daubenmeyer))

ggplot(cleandata, aes(x = Time.Category, y = Daubenmeyer)) + geom_jitter(size = 5, alpha = 0.1, width = 0.2) + facet_wrap(~Genus, ncol=2)

write.csv(cleandata, "focalgenera.csv")
```


